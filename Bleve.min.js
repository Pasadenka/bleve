!function(){if("undefined"==typeof Object.prototype.uniqueId){var e=0;Object.prototype.Id=function(){return"undefined"==typeof this.__uniqueid&&(this.__uniqueid=++e),this.__uniqueid}}}(),bleve=function(){var e="bleve-alpha";this.getVersion=function(){return e};var n=[],i=[],t=function(e,i){for(var t=0;t<n.length;t++)if(n[t].listener==e&&n[t].id==i)return n.splice(t,1)},s=function(e){for(var n=0;n<e.length;n++)t(e[n].listener,e[n].id)},r=function(e,i,t,s,r,d,o){i=0===i?{Id:function(){return 0}}:i,s=void 0===s?0:s,r="boolean"==typeof r?r:!1,d=void 0===d?null:d,o=void 0===o?!1:o,e&&n.push({listener:e,id:i.Id(),assigner:i,done:t,emitor:s,autoUnassign:r,dependency:d,did:o})},d=function(e,n,s){for(var r,d=0,o=0;o<i.length;o++)if(i[o].dependency===e.dependency){r=i[o];for(var a=0;a<r.children.length;a++)r.children[a].did===e.did&&(r.child=r.children[a]),r.children[a].called===!1&&d++}if(void 0!==typeof r)if("function"==typeof e.done&&e.done({emitor:n,data:s,assigner:e.assigner,dateTime:new Date}),r.child.called=!0,d--,e.autoUnassign&&t(e.listener,e.id),d);else if("function"==typeof r.done&&r.done({emitor:n,data:s,assigner:r.assigner,dateTime:new Date}),r.autoUnassign){for(var o=0;o<i.length;o++)if(i[o].assigner===r.assigner&&i[o].depyd===r.depyd)return i.splice(o,1)}else for(var a=0;a<r.children.length;a++)r.children[a].called=!1};this.getListeners=function(){return o.clone(n)},this.getDependence=function(){return o.clone(i)},this.dependencyAssign=function(e,n,t,s,d){crypto=crypto||msCrypto;var o=crypto.getRandomValues(new Uint32Array(1))[0],a=[];d="boolean"==typeof d?d:!1,n=0===n?{Id:function(){return 0}}:n;for(var f=0;f<t.length;f++)t[f].autoUnassign="boolean"==typeof t[f].autoUnassign?t[f].autoUnassign:d,a.push({did:f,called:!1}),r(t[f].listener,n,t[f].done,t[f].emitor,t[f].autoUnassign,o,f);i.push({assigner:n,done:s,autoUnassign:d,dependency:o,children:a,depyd:e})},this.assign=function(e,n,i,t,s){r(e,n,i,t,s)},this.unassign=function(e,n){t(e,n)},this.dependencyUnassign=function(e,t,s){for(var r=0;r<i.length;r++)if(i[r].assigner===s&&i[r].depyd===e){if(t)for(var d=0;d<i[r].children.length;d++)for(var o=0;o<n.length;o++)if(n[o].dependency===i[r].dependency&&n[o].id===i[r].children.id)return n.splice(o,1);return i[r].splice(r,1)}},this.emit=function(e,i,t){for(var r=[],o=0;o<n.length;o++)if(n[o].listener===e){var a=!1;n[o].emitor&&n[o].emitor===i.Id()&&(a=!0),n[o].emitor||(a=!0),a&&(n[o].dependency?d(n[o]):("function"==typeof n[o].done&&n[o].done({emitor:i,data:t,assigner:n[o].assigner,dateTime:new Date}),n[o].autoUnassign&&r.push({listener:e,id:n[o].id})))}s(r)}};var Bleve=new bleve;Object.prototype.bleve=new bleve,Object.prototype.unassign=function(e){Bleve.unassign(e,this.Id())},Object.prototype.dependencyUnassign=function(e,n){Bleve.dependencyUnassign(e,n,this.Id())},Object.prototype.assign=function(e,n,i,t){Bleve.assign(e,this,n,i,t)},Object.prototype.dependencyAssign=function(e,n,i,t){Bleve.dependencyAssign(e,this,n,i,t)},Object.prototype.emit=function(e,n){Bleve.emit(e,this,n)},unassign=function(e){Bleve.unassign(e,0)},assign=function(e,n,i,t){Bleve.assign(e,0,n,i,t)},dependencyAssign=function(e,n,i){Bleve.dependencyAssign(0,e,n,i)},emit=function(e,n){Bleve.emit(e,0,n)};
